<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Congrats</title>
    <link rel="stylesheet" href="app.css">
</head>
<body>
    <div class="container">
        <div id="end" class="flex-center flex-column">
            <h1 id="finalScore"></h1>
            <form>
                
                <button type="submit" class="btn" id="saveScoreBtn" onclick="saveHighScore(event)" >Save</button>
            </form>
            <a class="btn" href="game.html">Play Again</a>
            <a class="btn" href="indexx.html">Go Home</a>
        </div>
    </div>
    
    <!-- <script type="module">
        // Import 
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
        import { getDatabase, ref, set , onValue, push, child  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";
       
        // const firebaseConfig = {
        //   apiKey: "AIzaSyC1R9btd3eWN3M_xrmJ6K1-ye4EtcDScyY",
        //   authDomain: "first-74301.firebaseapp.com",
        //   projectId: "first-74301",
        //   storageBucket: "first-74301.appspot.com",
        //   messagingSenderId: "9783048559",
        //   appId: "1:9783048559:web:2fd169534323a559da909a",
        //   databaseURL: "https://first-74301-default-rtdb.firebaseio.com"
        // };
      

        const firebaseConfig = {
    apiKey: "AIzaSyC1R9btd3eWN3M_xrmJ6K1-ye4EtcDScyY",
    authDomain: "first-74301.firebaseapp.com",
    databaseURL: "https://first-74301-default-rtdb.firebaseio.com",
    projectId: "first-74301",
    storageBucket: "first-74301.appspot.com",
    messagingSenderId: "9783048559",
    appId: "1:9783048559:web:2fd169534323a559da909a"
  };
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const mostRecentScore = localStorage.getItem('mostRecentScore');
        const database  = getDatabase(app);

        onAuthStateChanged(auth, (user)=> {
            console.log(user);
            if (user) {
                console.log('Still going well');
            } else {
                console.log('user is not signed in');
               window.location.href = "indexx.html"
            }
        })

        document.getElementById('saveScoreBtn').addEventListener('click', ()=> {
           
            let dbRef =  ref(database, "highScoreStore")


          push(dbRef, {
                score: mostRecentScore,
                userName : auth.currentUser.displayName
            })

        
        })

       


        </script> -->

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

            const firebaseConfig = {
    apiKey: "AIzaSyC1R9btd3eWN3M_xrmJ6K1-ye4EtcDScyY",
    authDomain: "first-74301.firebaseapp.com",
    databaseURL: "https://first-74301-default-rtdb.firebaseio.com",
    projectId: "first-74301",
    storageBucket: "first-74301.appspot.com",
    messagingSenderId: "9783048559",
    appId: "1:9783048559:web:2fd169534323a559da909a"
  };
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const database = getDatabase(app);
            const dbRef = ref(database, "highScoreStore");
            const userScoreRef = ref(dbRef, userName);
            const userName = auth.currentUser.displayName;
        
            document.getElementById('saveScoreBtn').addEventListener('click', () => {
               
          
                const mostRecentScore = mostRecentScore;
                
        
                set(userScoreRef, {
                    score: mostRecentScore,
                    userName: userName
                });
        
                alert("Score saved successfully!");
            });
        </script>
    <script src="end.js"></script>
</body>
</html>